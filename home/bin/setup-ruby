#!/bin/bash -ex
ensure_gem_installed() {
  for gem in $@; do
    `gem list -i $gem` || gem install $gem
  done
}

LATEST_RUBY=1.9.3-p194
LATEST_RUBY_PATCHED=$LATEST_RUBY-falcon

[[ -d ~/.rbenv ]] || git clone https://github.com/sstephenson/rbenv.git ~/.rbenv
[[ -d ~/.rbenv/plugins ]] || mkdir ~/.rbenv/plugins
[[ -d ~/.rbenv/plugins/ruby-build ]] || git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
[[ -d ~/.rbenv/plugins/rbenv-gemset ]] || git clone https://github.com/jamis/rbenv-gemset.git ~/.rbenv/plugins/rbenv-gemset

[[ -d ~/.rbenv/versions/$LATEST_RUBY_PATCHED ]] || (curl https://raw.github.com/gist/2600122/rbenv.sh | sh && ~/.rbenv/bin/rbenv global $LATEST_RUBY_PATCHED)

ensure_gem_installed bundler pry pry-doc
